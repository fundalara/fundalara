<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="Etadistico" language="groovy" pageWidth="595" pageHeight="842" columnWidth="555" leftMargin="20" rightMargin="20" topMargin="20" bottomMargin="20">
	<property name="ireport.zoom" value="1.0"/>
	<property name="ireport.x" value="0"/>
	<property name="ireport.y" value="192"/>
	<style name="Crosstab Data Text" hAlign="Center"/>
	<parameter name="FechaInicio" class="java.util.Date"/>
	<parameter name="FechaFin" class="java.util.Date"/>
	<queryString>
		<![CDATA[select
	distinct estado_actividad.codigo_estado,
	count (estado_actividad.codigo_estado) as cantidadEstado,
	tablaEstado.NombreEstado


from
	estado_actividad, dato_basico, actividad, planificacion_actividad,
	(select dato_basico.nombre as NombreEstado,
	dato_basico.codigo_dato_basico as CodigoEstado

		from dato_basico

		where dato_basico.codigo_tipo_dato = 104) tablaEstado
where

	dato_basico.estatus ='A' and
	estado_actividad.codigo_actividad = actividad.codigo_actividad and
	actividad.codigo_planificacion_actividad = planificacion_actividad.codigo_planificacion_actividad and
	planificacion_actividad.codigo_tipo_actividad = dato_basico.codigo_dato_basico and
	dato_basico.parent_codigo_dato_basico = 501  and
	tablaEstado.CodigoEstado = estado_actividad.codigo_estado and
	actividad.fecha_inicio between $P{FechaInicio} and $P{FechaFin} and
	actividad.fecha_culminacion between $P{FechaInicio}  and $P{FechaFin}



group by estado_actividad.codigo_estado, tablaEstado.NombreEstado
order by codigo_estado]]>
	</queryString>
	<field name="codigo_estado" class="java.lang.Integer"/>
	<field name="cantidadestado" class="java.lang.Long"/>
	<field name="nombreestado" class="java.lang.String"/>
	<variable name="cantidadestado_SUM" class="java.lang.Long" calculation="Sum">
		<variableExpression><![CDATA[$F{cantidadestado}]]></variableExpression>
	</variable>
	<variable name="codigo_estado_SUM" class="java.lang.Integer" calculation="Sum">
		<variableExpression><![CDATA[$F{codigo_estado}]]></variableExpression>
	</variable>
	<variable name="cantidadestado_SUM_1" class="java.lang.Long" calculation="Sum">
		<variableExpression><![CDATA[$F{cantidadestado}]]></variableExpression>
	</variable>
	<variable name="cantidadestado_SUM_2" class="java.lang.Long" calculation="Sum">
		<variableExpression><![CDATA[$F{cantidadestado}]]></variableExpression>
	</variable>
	<background>
		<band splitType="Stretch"/>
	</background>
	<title>
		<band height="153" splitType="Stretch">
			<staticText>
				<reportElement x="399" y="110" width="41" height="20"/>
				<textElement>
					<font fontName="Arial" size="12" isBold="true"/>
				</textElement>
				<text><![CDATA[Fecha:]]></text>
			</staticText>
			<staticText>
				<reportElement x="399" y="132" width="41" height="20"/>
				<textElement>
					<font fontName="Arial" size="12" isBold="true"/>
				</textElement>
				<text><![CDATA[Hora:]]></text>
			</staticText>
			<textField pattern="dd/MM/yyyy">
				<reportElement x="440" y="110" width="100" height="20"/>
				<textElement>
					<font fontName="Arial" size="12"/>
				</textElement>
				<textFieldExpression><![CDATA[new java.util.Date()]]></textFieldExpression>
			</textField>
			<textField pattern="h.mm a">
				<reportElement x="441" y="132" width="100" height="20"/>
				<textElement>
					<font fontName="Arial" size="12"/>
				</textElement>
				<textFieldExpression><![CDATA[new java.util.Date()]]></textFieldExpression>
			</textField>
			<image>
				<reportElement x="0" y="0" width="555" height="132"/>
				<imageExpression><![CDATA["C:\\Users\\Reinaldo López\\Documents\\repositorio\\fundalara\\WebContent\\Recursos\\Imagenes\\Encabezado.jpg"]]></imageExpression>
			</image>
		</band>
	</title>
	<pageHeader>
		<band height="45" splitType="Stretch">
			<staticText>
				<reportElement x="0" y="0" width="555" height="45"/>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Arial" size="24" isBold="true"/>
				</textElement>
				<text><![CDATA[Actividades Complementarias Por Estado]]></text>
			</staticText>
		</band>
	</pageHeader>
	<columnHeader>
		<band height="39" splitType="Stretch">
			<staticText>
				<reportElement x="72" y="7" width="45" height="20"/>
				<textElement textAlignment="Justified" verticalAlignment="Middle">
					<font fontName="Arial" size="12" isBold="true"/>
				</textElement>
				<text><![CDATA[Desde:]]></text>
			</staticText>
			<staticText>
				<reportElement x="304" y="7" width="61" height="20"/>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Arial" size="14" isBold="true"/>
				</textElement>
				<text><![CDATA[Hasta:]]></text>
			</staticText>
			<textField pattern="dd/MM/yyyy">
				<reportElement x="118" y="7" width="100" height="20"/>
				<textElement textAlignment="Justified" verticalAlignment="Middle">
					<font fontName="Arial" size="12"/>
				</textElement>
				<textFieldExpression><![CDATA[$P{FechaInicio}]]></textFieldExpression>
			</textField>
			<textField pattern="yyyy/MM/dd">
				<reportElement x="365" y="7" width="100" height="20"/>
				<textElement textAlignment="Justified" verticalAlignment="Middle">
					<font size="12"/>
				</textElement>
				<textFieldExpression><![CDATA[$P{FechaFin}]]></textFieldExpression>
			</textField>
		</band>
	</columnHeader>
	<pageFooter>
		<band height="111" splitType="Stretch">
			<textField>
				<reportElement x="441" y="80" width="67" height="20"/>
				<textElement textAlignment="Right">
					<font fontName="Arial" size="12" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA["Página "+$V{PAGE_NUMBER}+" de"]]></textFieldExpression>
			</textField>
			<textField evaluationTime="Report">
				<reportElement x="508" y="80" width="42" height="20"/>
				<textElement>
					<font fontName="Arial" size="12" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA[" " + $V{PAGE_NUMBER}]]></textFieldExpression>
			</textField>
			<image>
				<reportElement x="0" y="3" width="552" height="74"/>
				<imageExpression><![CDATA["C:\\Users\\Reinaldo López\\Documents\\repositorio\\fundalara\\WebContent\\Recursos\\Imagenes\\PieDePagina.jpg"]]></imageExpression>
			</image>
		</band>
	</pageFooter>
	<summary>
		<band height="237" splitType="Stretch">
			<elementGroup/>
			<pieChart>
				<chart>
					<reportElement x="14" y="43" width="526" height="194"/>
					<chartTitle position="Top"/>
					<chartSubtitle/>
					<chartLegend position="Bottom">
						<font fontName="Arial" size="12" pdfFontName="Times-Roman"/>
					</chartLegend>
				</chart>
				<pieDataset>
					<keyExpression><![CDATA[$F{nombreestado}]]></keyExpression>
					<valueExpression><![CDATA[$F{cantidadestado}]]></valueExpression>
					<labelExpression><![CDATA[$F{nombreestado}+"="+$F{cantidadestado}]]></labelExpression>
				</pieDataset>
				<piePlot>
					<plot/>
					<itemLabel/>
				</piePlot>
			</pieChart>
			<staticText>
				<reportElement x="182" y="7" width="129" height="23"/>
				<textElement verticalAlignment="Middle">
					<font fontName="Arial" size="12" isBold="true"/>
				</textElement>
				<text><![CDATA[Total de Actividaddes:]]></text>
			</staticText>
			<textField>
				<reportElement x="312" y="8" width="40" height="20"/>
				<textElement verticalAlignment="Middle">
					<font fontName="Arial" size="12" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$V{cantidadestado_SUM}]]></textFieldExpression>
			</textField>
		</band>
	</summary>
</jasperReport>
